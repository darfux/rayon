<% content_for :head do %>
<%= stylesheet_link_tag "match", media: "all" %>
<!-- <script type="text/javascript">)</script> -->
<script>
function test_click(){
  $('#test').click(
    function(){
      $.getJSON('http://127.0.0.1:3000/match/status', function(data){
        console.log(data);
        if(data.status == 'CHANGE')
        {
          for(i in data.loaded)
          { 
            var loaded = $('.loding-info-container').children()[i];
            $(loaded).css('display','block'); //not inline
            $(loaded).addClass('loaded');
            $(loaded).removeClass('loading');
            content = $(loaded).html();
            $(loaded).html('已匹配'+content+'库...');
            console.log();
          }
          var loading = $('.loding-info-container').children()[data.loading];
          content = $(loading).html();
          $(loading).html('正在检索'+content+'库...');
          $(loading).css('display','block');
        }
      });
      // $('.loading').addClass('loaded');
      // $('.loading').removeClass('loading');
  });
}
$(document).ready(function(){
  test_click();
  $('.loding-info-container').children().slice(1).css('display','none');
  $('.loding-info-container').css('display','inline');
});

</script>
<% end %>
<% content_for :main_content do %>
<!-- main content -->
<div class="container match-loading">
  <div>
    <h1><b>刘静</b>老师，正在为您匹配，请稍候</h1>
  </div>
  <div class="progress progress-striped active">
    <div class="progress-bar"  role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%">
      <span class="sr-only">0% Complete</span>
    </div>
  </div>
    <button id='test'>Test</button>
  <div class="loding-info-container">
    <div class="loading-info achievement loading">成果</div>
    <div class="loading-info expert loading">专家</div>   
    <div class="loading-info paper loading">文献</div>   
    <div class="loading-info project loading">项目</div>
  </div>

</div>
<% end #content_for%>